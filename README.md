# AkiDefence
策略小游戏“秋姐妹红薯保卫战”

## 游戏背景

由于幽幽子引发的第二次春雪异变，幻想乡发生了粮食歉收。

饥肠辘辘的魔理沙开始了出门寻找食物之旅，笨蛋冰之妖精也好奇地跟了过去。

她们找到了秋姐妹。秋姐妹作为丰收的神明，家里存储了不少红薯。

在一番讨要无果后，魔理沙决定至少不能先饿死，红薯的事以后再还吧~

## 规则描述

在四连通方格地图上，秋姐妹和雾雨魔理沙魔理沙与琪露诺的组合展开关于红薯的争夺战。

其中2人为穰子和魔理沙，3人再加上静叶，4人再加上琪露诺。

### 操作

操作

每一秒，每人均可以选择如下的操作之一:

1.移动。可以向上下左右移动一格，只要没有障碍物。

如果移动途中或者停下后有两人相撞，则移动无效并且双方均失去一定HP(失去HP数和地图有关)。如果多人相撞，失去的HP累加。可能出现连锁反应，详见移动碰撞细则。

2.静止不动，直接进入下一秒。

3.取红薯。当紧挨着红薯堆，并且篮筐里红薯数量没有达到上限时，可以选择取一个红薯。

4.放红薯。当紧挨着雾雨魔法店，并且篮筐里有红薯时，可以选择将红薯放入神社。

5.扔红薯。篮筐里有红薯时，可以将手中的红薯扔到前后左右任意一个方向，范围为2。

红薯砸中对手，则对手失去一定HP(和地图有关，下同)，扔出去的红薯瞬间落到所选的位置，并且不可捡回。

红薯砸中队友，则不会造成伤害，而是会给队友篮筐中的红薯量+1，超过上限则红薯浪费。

6.吃红薯。手中有红薯时，吃掉红薯并回复1点HP。

### 交互场景

注:机关类场景均含有颜色

1.红薯仓库

秋姐妹家的红薯仓库。

任何一人站在仓库邻格，篮筐里红薯未满，即可花费1秒取一个红薯。

2.雾雨魔法店

魔理沙的家。

任何一人站在魔法店邻格，篮筐里有红薯，即可花费1秒放下一个红薯。

放下红薯后魔法店的红薯数量+1(游戏开始时为0)。放下的红薯不能再捡回。

3.墙

简单的阻挡类场景。

无法阻挡扔出的红薯，但能阻挡人的前进。

4.钉板陷阱

机关类场景。平时埋在地下，对应颜色被激活即可升起。

升起后可对在上面静止不动的人造成一定伤害，如果对方这一秒从其他格移动到此格，也造成同样的伤害。

5.活动墙

机关类场景。平时埋在地下，对应颜色被激活即可升起。

升起后等价于一堵普通墙。若有人这一秒站在此格或者从其他位置来到此格，则墙无法升起。

6.踏板

机关类场景。踩上去能激活对应的颜色。

7.大树

站在邻格，每回合可以使HP增加一定值L，若L=0，则为普通树。

L>0，则为生命之树，L<0，则为死亡之树。

大树的叶子默认为绿色，被转化为红色时L取相反数。


### 每秒结束时事件的发生顺序

吃到的红薯使双方补血(不能超过上限)。

移动和碰撞伤害判定(详见移动碰撞细则)。

大树的补血(绿叶生命之树，红叶死亡之树)(不能超过上限)。

大树的扣血(红叶生命之树，绿叶死亡之树)。

二人碰撞扣血。

投掷的红薯使双方扣血/传递给队友。

机关、活动墙升起和落下。

机关扣血。

红薯的放下和拿起。(刚刚传递的红薯无法被放下)

### 被动技

秋静叶

1.掌管红叶程度的能力

每秒钟，所有在静叶邻格的大树树叶变为红色，静叶离开后变回原色。

2.免受红叶之伤程度的能力

红叶生命之树对静叶不会造成任何伤害。

3.支援型角色

篮筐容量为0。

可以自由进出红薯仓库，在仓库中驻守时可视为篮筐里永远有红薯，但是投掷距离会缩短为1格。

琪露诺

1.妖精的自然之力

在绿叶生命之树的影响范围下，投掷红薯的伤害加倍。

在绿叶死亡之树的影响范围下，投掷红薯的伤害减半。

同时与多个大树相邻，影响效果叠加，最终产生的伤害值向下取整。

2.操纵冷气程度的能力

站在红薯仓库邻格，除自己和已经在仓库中的静叶以外，其他人不能从此仓库中拿红薯。

3.好奇心

琪露诺只是因为好奇而参加这场战斗，因此不能向雾雨魔法店搬运红薯。

### 移动碰撞细则

1.所有角色的移动如果因为撞到场景或越界而失败，则移动操作本身无效，被转化为静止不动操作。

2.所有角色无视碰撞移动到目标格子。如果某角色从A格移动到B格，则在A和B的边界留下痕迹。

3.对于所有两个格子的边界，如果它被两个角色留下过痕迹，则这两个角色的移动无效，分别受到1次碰撞伤害，并无视碰撞地退回上一秒所在的格子。

4.对于所有至少两个角色在其上的格子，假设这个格子上站了k个角色，那么这k个角色的移动都无效，无视碰撞地退回上一秒所在的格子。这k个角色分别受到k-1次碰撞伤害。重复这一步骤直到所有格子上最多只站一个角色。

### 流程

游戏有时间上限。当某次行动后，时间达到最大时间，则红薯保卫战结束。

战斗过程中，若某次行动后魔理沙的HP为0，战斗也立即结束。

战斗结束时，魔理沙和琪露诺的最终得分为雾雨魔法店中的红薯总数。

## 版权声明

本作品为东方project的二次创作，原作者「上海アリス幻樂団」。

本作品的源代码采用GNU General Public License v3.0协议。

### 关于三次创作

1.如以东方为背景，需要遵守ZUN先生发布的东方二次创作规定。

2.非盈利用途的再创作不受限制，但如使用本作品的源代码，需要遵守相应开源协议。

3.在本作品内容基础上所进行的软件类再创作，如用作盈利目的，需公开源代码，并遵守GNU General Public License v3.0协议。

4.其他类型用于盈利目的再创作请联系本作品的作者。
